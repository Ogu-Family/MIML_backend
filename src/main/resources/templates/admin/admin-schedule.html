<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>영화 일정 추가 페이지</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <form action="/admin/schedule" method="post">
    <div>
      <p>영화 선택</p>
      <select class="form-select" onchange="showSelectedMovieInfo(this)">
        <option selected>상영할 영화를 선택합니다.</option>
        <option th:id="'movie' + ${movie.id}" th:each="movie: ${movieResponse.data}" th:value="${movie.id}" th:text="${movie.title}" th:attr="data-poster=${movie.poster}, data-movie-id=${movie.id}, data-director=${movie.director}">목록</option>
      </select>
    </div>
    <div>
      <div style="display: flex; align-items: center; justify-content: center; padding: 1rem">
        <img id="movieImg" th:src="@{/default.png}" alt="영화 포스터" width="300"/>
        <div>
          <p id="movieId">영화 id</p>
          <p id="movieDirector">감독</p>
        </div>
      </div>
    </div>
    <div>
      <label for="movieSelect">영화관 선택</label>
      <select id="movieSelect" class="form-select"></select>
      <label for="screenSelect">상영관 선택</label>
      <select id="screenSelect" class="form-select"></select>
    </div>
    <div>
      <label for="startTime">상영 시작 시각</label>
      <input type="datetime-local" id="startTime" name="startTime">
      <label for="endTime">상영 종료 시각</label>
      <input type="datetime-local" id="endTime" name="endTime">
    </div>
    <br />
    <br />
    <div>
      <button type="submit">제출</button>
    </div>
  </form>
</body>
<script th:inline="javascript">
  const showSelectedMovieInfo = (selectTag) => {
    console.log(selectTag.value);

    const selectedOption = document.querySelector("#movie" + selectTag.value);

    document.querySelector("#movieImg").src = selectedOption.getAttribute("data-poster");
    document.querySelector("#movieId").textContent = selectedOption.getAttribute("data-movie-id");
    document.querySelector("#movieDirector").textContent = selectedOption.getAttribute("data-director");
  }
</script>
</html>
